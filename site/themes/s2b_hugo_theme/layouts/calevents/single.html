<!DOCTYPE html>
<html lang="{{ .Site.LanguageCode }}">

<head>
  {{ partial "head.html" . }}
  {{ partial "cal/head.html" . }}
</head>

<body>

  <div id="all">

    <header>
      {{ partial "nav.html" . }}
    </header>

    <main>
        {{ partial "breadcrumbs.html" . }}

        <div id="content">
          <div class="container">

            <div class="row">

              <div class="col-md-12">

                <div>
                  {{ if isset .Params "pp" }}
                    <!-- on PP cal page, display full PP header -->
                    {{ partial "cal/pp-header.html" . }}
                  {{ else }}
                    <!-- on other cal pages, display smaller banner that links to PP cal page -->
                    <!-- only display when PP is coming soon or happening now -->
                    {{ partial "cal/pp-promo-banner.html" . }}

                    <!-- only display during Steptember -->
                    <!-- {{ partial "cal/promo-banner-steptember.html" . }} -->
                  {{ end }}

                  {{ .Content }}
                </div>

                <div id="fullcalendar"></div>

                {{ if isset .Params "pp" }}
                  {{ partial "cal/pp-feed.html" . }}
                {{ end }}

                <div id="mustache-html" class="container">

                </div>

                {{ if isset .Params "pp" }}
                  {{ partial "cal/promo-banner-main-cal.html" . }}
                {{ end }}

                {{ partial "alert_banner.html" . }}

                {{ partial "disclaimer.html" . }}

              </div>

            </div>
            <!-- /.row -->

          </div>
          <!-- /.container -->
        </div>
        <!-- /#content -->
    </main>

    <footer>
      {{ partial "footer.html" . }}
    </footer>

  </div>
  <!-- /#all -->

  {{ partial "scripts.html" . }}{{/* for jquery */}}
  {{ partial "cal/events.html" . }}
  {{ partial "cal/scripts.html" . }}{{/* for parseURL() */}}
  <script type="text/javascript">
    $(document).ready(function() {
      const params = parseURL();
      if ('eventId' in params) {
        // view single event
        // ex. https://shift2bikes.org/calendar/event-2112
        viewEvent(params['eventId']); // in main.js, included by events.html
      } else {
        // view list of events
        // ex. https://shift2bikes.org/calendar/
        // note pp is 'true' for:
        // - site/content/pedalpalooza-calendar.md ( during some parts of the year )
        // - site/content/archive/pedalpalooza/pedalpalooza-2005.md ( in perpetuity )
        if ({{ .Params.pp }}) {
          params.pp = true;
          params.startdate = {{ .Params.startdate }};
          params.enddate = {{ .Params.enddate }};
        }
        viewEvents(params); // in main.js, included by events.html
      }
    });
  </script>

</body>
</html>
